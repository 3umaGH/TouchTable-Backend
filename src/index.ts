import {
  ClientToServerEvents,
  ServerToClientEvents,
  InterServerEvents,
} from "./types/socket";
import { mockCategories, mockDishes } from "./mockData";
import { Server } from "socket.io";
import { Restaurant } from "./restaurant/Restaurant";
import { RestaurantAggregator } from "./restaurant/RestaurantAggregator";
import { SocketManager } from "./socket/SocketManager";
import { StatisticsManager } from "./statistics/StatisticsManager";

require("socket.io");

const io = new Server<
  ClientToServerEvents,
  ServerToClientEvents,
  InterServerEvents
>({
  connectionStateRecovery: {},
  pingTimeout: 7000,
  pingInterval: 3000,
  cors: {
    origin: "*",
  },
});

const vapianoTheme = {
  primary200: "#de5274",
  primary300: "#de214f",
  primary600: "#e00036",
  isLightTheme: true,
};

const joyceTheme = {
  primary200: "#696969",
  primary300: "#474747",
  primary600: "#383838",
  isLightTheme: false,
};

/* Mock restaurants */
const restaurant = new Restaurant(
  0,
  "Name",
  /*"data:image/png;base64,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",*/
  "https://joyce.ee/wp-content/themes/spa_hotell/theme-joyce/images/header-logo.png",
  vapianoTheme,
  mockDishes,
  mockCategories,
  5
);

export const restaurants = new Map<number, Restaurant>();

restaurants.set(0, restaurant);

const aggregator = new RestaurantAggregator(restaurants);
aggregator.initalizeListeners();

const socketManager = new SocketManager(aggregator);
socketManager.startListening(3001);
socketManager.initalizeListeners();

const statisticsManager = new StatisticsManager(aggregator);
statisticsManager.initalizeListeners();
